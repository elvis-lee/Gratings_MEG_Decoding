% Script generated by Brainstorm (24-Nov-2015)

for i=3:16
    if i==4 
        continue;
    end
    directory  =  ['/dataslow/sheng/Project of Sheng/brainstorm_db'...
        '/sheng/data/grating' num2str(i, '%.2d')];
    source_dir = [directory '/@default_study/'];
    file_dir = [directory '/1/']
    source = dir([source_dir '*dSPM*']);
    file = dir([file_dir 'data*average*']);
    % Input files
    sFiles = {...
        ['link|grating' num2str(i, '%.2d') '/@default_study/' source(1).name...
        '|grating' num2str(i, '%.2d') '/1/' file(1).name]};

    % Start a new report
    bst_report('Start', sFiles);

    % Process: Time-frequency (Morlet wavelets)
    sFiles = bst_process('CallProcess', 'process_timefreq', sFiles, [], ...
        'clusters', {}, ...
        'scoutfunc', 1, ...  % Mean
        'normalize', 0, ...
        'edit', struct(...
             'Comment', 'Power,54-54Hz', ...
             'TimeBands', [], ...
             'Freqs', 28, ...
             'MorletFc', 1, ...
             'MorletFwhmTc', 4, ...
             'ClusterFuncTime', 'none', ...
             'Measure', 'power', ...
             'Output', 'all', ...
             'SaveKernel', 0));

    % Save and display report
    ReportFile = bst_report('Save', sFiles);
    bst_report('Open', ReportFile);

end